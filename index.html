<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Aplicación completa para el seguimiento de cuidados post implante capilar con recordatorios, progreso visual y guías detalladas">
  <meta name="keywords" content="implante capilar, cuidados post operatorios, recuperación, seguimiento">
  <meta name="author" content="Hair Care App">
  <title>Cuidados Diario Post Implante Capilar - Seguimiento Completo</title>
  
  <!-- Preconnect para mejorar rendimiento -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiQ3VpZGFkb3MgUG9zdCBJbXBsYW50ZSBDYXBpbGFyIiwic2hvcnRfbmFtZSI6IkNhcGlsYXJDYXJlIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiNlYWYyZjgiLCJ0aGVtZV9jb2xvciI6IiMyODc0YTYiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lpSUhacFpYZENiM2c5SWpBZ01DQXhNamd1TURBd01EQXhNamd1TURBd01EQWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStQR05wY21Oc1pTQmplRDBpTmpRaUlHTjVQU0kyTkNJZ2NqMGlOVEFpSUdacGJHdzlJaU15T0RjMFlUWWlMejQ4TDNOMlp6ND0iLCJzaXplcyI6IjEyOHgxMjgiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOC4wMDAwMTI4LjAwMDAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxjaXJjbGUgY3g9IjY0IiBjeT0iNjQiIHI9IjUwIiBmaWxsPSIjMjg3NGE2Ii8+PC9zdmc+">
  
  <style>
    /* Variables CSS mejoradas */
    :root {
      --bg-primary: #f8fafc;
      --bg-secondary: #e2e8f0;
      --bg-card: #ffffff;
      --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --text-primary: #1a202c;
      --text-secondary: #4a5568;
      --text-muted: #718096;
      --accent-primary: #3182ce;
      --accent-secondary: #2c5282;
      --accent-success: #38a169;
      --accent-warning: #d69e2e;
      --accent-error: #e53e3e;
      --accent-info: #3182ce;
      --border-light: #e2e8f0;
      --border-medium: #cbd5e0;
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --transition-fast: 0.15s ease-in-out;
      --transition-normal: 0.3s ease-in-out;
      --transition-slow: 0.5s ease-in-out;
    }

    /* Dark mode variables */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-primary: #1a202c;
        --bg-secondary: #2d3748;
        --bg-card: #2d3748;
        --text-primary: #f7fafc;
        --text-secondary: #e2e8f0;
        --text-muted: #a0aec0;
        --border-light: #4a5568;
        --border-medium: #718096;
      }
    }

    /* Reset y base */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: var(--font-family);
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
    }

    /* Layout principal */
    .app-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--bg-gradient);
      padding: 1rem;
    }

    .main-content {
      flex: 1;
      max-width: 800px;
      margin: 0 auto;
      width: 100%;
    }

    /* Header mejorado */
    .app-header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 2rem 1rem;
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.95);
    }

    .app-title {
      font-size: clamp(1.5rem, 4vw, 2.5rem);
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .app-subtitle {
      font-size: 1.2rem;
      color: var(--text-primary);
      font-weight: 500;
    }

    /* Tarjetas mejoradas */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid var(--border-light);
      transition: all var(--transition-normal);
    }

    .card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-light);
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* Formulario mejorado */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }

    .form-input {
      width: 100%;
      padding: 0.875rem 1rem;
      font-size: 1rem;
      border: 2px solid var(--border-light);
      border-radius: var(--radius-md);
      background: var(--bg-card);
      color: var(--text-primary);
      transition: all var(--transition-fast);
      font-family: inherit;
    }
    
    .form-input[readonly] {
        background-color: var(--bg-secondary);
        cursor: not-allowed;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
    }

    /* Progress bar */
    .progress-container {
      margin-bottom: 1rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .progress-label {
      font-weight: 500;
      color: var(--text-primary);
    }

    .progress-percentage {
      font-weight: 600;
      color: var(--accent-primary);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-success));
      border-radius: var(--radius-sm);
      transition: width var(--transition-slow);
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* Output mejorado */
    .output-container {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      overflow: hidden;
      border: 1px solid var(--border-light);
    }

    .output-header {
      background: var(--bg-gradient);
      color: white;
      padding: 1rem 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .output-content {
      padding: 1.5rem;
      min-height: 200px;
    }

    .day-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--accent-primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .phase-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: var(--radius-sm);
      font-size: 0.75rem;
      font-weight: 600;
      color: white;
      margin-left: 0.5rem;
    }

    .care-list {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .care-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border-light);
      transition: all var(--transition-fast);
    }

    .care-item:last-child {
      border-bottom: none;
    }

    .care-item:hover {
      background: var(--bg-secondary);
      margin: 0 -1rem;
      padding-left: 1rem;
      padding-right: 1rem;
      border-radius: var(--radius-sm);
    }

    .care-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 0.125rem;
    }

    .care-text {
      flex: 1;
      color: var(--text-primary);
      line-height: 1.5;
    }

    /* Milestone */
    .milestone {
      margin-top: 1.5rem;
      padding: 1rem;
      background: linear-gradient(135deg, var(--accent-info), var(--accent-primary));
      color: white;
      border-radius: var(--radius-md);
      font-weight: 500;
      text-align: center;
      box-shadow: var(--shadow-sm);
    }

    /* Stats cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: var(--bg-card);
      padding: 1.5rem;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      text-align: center;
      border: 1px solid var(--border-light);
      transition: all var(--transition-normal);
    }

    .stat-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* Notifications */
    .notification {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: var(--bg-card);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      padding: 1rem 1.5rem;
      max-width: 400px;
      z-index: 1000;
      transform: translateX(100%);
      transition: transform var(--transition-normal);
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification-success {
      border-left: 4px solid var(--accent-success);
    }

    .notification-error {
      border-left: 4px solid var(--accent-error);
    }

    .notification-info {
      border-left: 4px solid var(--accent-info);
    }

    /* Responsive design mejorado */
    @media (max-width: 768px) {
      .app-container {
        padding: 0.5rem;
      }
      
      .card {
        padding: 1rem;
        margin-bottom: 1rem;
      }
      
      .app-header {
        padding: 1.5rem 1rem;
        margin-bottom: 1.5rem;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .notification {
        top: 0.5rem;
        right: 0.5rem;
        left: 0.5rem;
        max-width: none;
      }
    }

    /* Animation utilities */
    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <div class="main-content">
      <!-- Header -->
      <header class="app-header">
        <h1 class="app-title">🌱 Cuidados Post Implante Capilar</h1>
        <p class="app-subtitle">Tu guía personal para una recuperación exitosa.</p>
      </header>

      <!-- Stats Cards -->
      <div class="stats-grid" id="statsGrid" style="display: none;">
        <div class="stat-card">
          <div class="stat-value" id="daysSinceValue">-</div>
          <div class="stat-label">Días transcurridos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="progressValue">-</div>
          <div class="stat-label">Progreso</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="nextMilestoneValue">-</div>
          <div class="stat-label">Próximo hito</div>
        </div>
      </div>

      <!-- Input Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            📅 Fecha del Implante
          </h2>
        </div>
        
        <form id="careForm" novalidate>
          <div class="form-group">
            <input 
              type="date" 
              id="implantDate" 
              class="form-input"
              value="2025-06-04"
              readonly
            >
          </div>

          <!-- Progress Bar -->
          <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-header">
              <span class="progress-label">Progreso de recuperación</span>
              <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
          </div>
        </form>
      </div>

      <!-- Output Card -->
      <div class="card output-container" id="outputCard" style="display: none;">
        <div class="output-header">
          <span>📋 Cuidados recomendados</span>
        </div>
        <div class="output-content" id="outputContent" aria-live="polite">
          <!-- Content will be populated by JavaScript -->
        </div>
      </div>
    </div>
  </div>

  <!-- Notification container -->
  <div id="notificationContainer"></div>

  <script>
    (() => {
      'use strict';

      // Utility functions
      const $ = (selector) => document.querySelector(selector);
      const createElement = (tag, className = '', content = '') => {
        const el = document.createElement(tag);
        if (className) el.className = className;
        if (content) el.textContent = content;
        return el;
      };

      // DOM elements
      const elements = {
        dateInput: $('#implantDate'),
        outputCard: $('#outputCard'),
        outputContent: $('#outputContent'),
        statsGrid: $('#statsGrid'),
        daysSinceValue: $('#daysSinceValue'),
        progressValue: $('#progressValue'),
        nextMilestoneValue: $('#nextMilestoneValue'),
        progressContainer: $('#progressContainer'),
        progressFill: $('#progressFill'),
        progressPercentage: $('#progressPercentage'),
        notificationContainer: $('#notificationContainer')
      };

      // Configuration
      const config = {
        notificationDuration: 5000
      };

      // Enhanced and more specific care data
      const careData = [
        {
          maxDay: 3,
          phase: 'Crítica',
          color: '#e53e3e',
          tasks: [
            'No tocar, rascar ni frotar la zona injertada bajo ninguna circunstancia para no dañar los folículos.',
            'Dormir en posición semi-sentado (ángulo de 45°) usando un cojín de viaje o varias almohadas para minimizar la hinchazón.',
            'Pulverizar suero fisiológico estéril sobre la zona receptora y donante cada 1-2 horas para mantenerla hidratada.',
            'Evitar exposición solar directa, calor extremo (saunas, secadores), polvo, humo y el uso de gorras o sombreros ajustados.',
            'Seguir estrictamente la pauta de medicación prescrita: antibióticos, antiinflamatorios y analgésicos.',
            'Beber al menos 2-3 litros de agua al día para favorecer la cicatrización y reducir la inflamación.',
            'Reposo absoluto. Evitar movimientos bruscos, agacharse o levantar objetos pesados.',
            'Prohibido el consumo de alcohol, tabaco y bebidas con cafeína, ya que interfieren en la cicatrización.',
            'Si hay inflamación en la frente, aplicar compresas frías (nunca directamente sobre la zona injertada).'
          ]
        },
        {
          maxDay: 10,
          phase: 'Inicial',
          color: '#d69e2e',
          tasks: [
            'Realizar el primer lavado según las instrucciones de la clínica, usando el champú especial (pH neutro, sin sulfatos) y aplicando con toques suaves, sin frotar.',
            'Las costras comenzarán a formarse y caerán solas. No arrancarlas para evitar la pérdida de folículos.',
            'No utilizar peines o cepillos en la zona. Evitar camisetas de cuello estrecho que puedan rozar al ponerlas/quitarlas.',
            'Continuar con abstinencia total de alcohol y tabaco.',
            'Prohibido sumergirse en piscinas, mar o usar saunas y baños turcos por riesgo de infección.',
            'Aplicar los productos post-operatorios recomendados (sprays, espumas con factores de crecimiento) según la pauta.',
            'Seguir durmiendo con la cabeza elevada para controlar la inflamación residual.',
            'Continuar con la hidratación con suero fisiológico, aunque con menor frecuencia (3-4 veces al día).',
            'Evitar cualquier tipo de ejercicio físico o actividad que provoque sudoración.'
          ]
        },
        {
          maxDay: 14,
          phase: 'Estabilización',
          color: '#d69e2e',
          tasks: [
            'Realizar lavados diarios con la yema de los dedos, con movimientos circulares muy suaves para ayudar a que las últimas costras se desprendan.',
            'Se puede empezar a usar gorras holgadas para protegerse del sol, pero sin que ejerzan presión.',
            'Introducir ejercicio muy ligero como paseos cortos. Evitar deportes de contacto o de alta intensidad.',
            'Es normal sentir algo de picor. Si es muy intenso o el enrojecimiento persiste, contactar con la clínica.',
            'Fomentar una dieta rica en antioxidantes: frutos rojos, brócoli, espinacas, etc.',
            'Se pueden iniciar masajes muy suaves en la zona de la nuca (donante) para mejorar la circulación, nunca en la zona receptora.',
            'La protección solar es obligatoria. Usar sombreros o protector solar específico para cuero cabelludo si se va a estar al aire libre.',
            'Mantener la piel de la zona hidratada con los productos recomendados por el especialista.'
          ]
        },
        {
          maxDay: 30,
          phase: 'Recuperación',
          color: '#38a169',
          tasks: [
            'Se puede volver a la rutina de lavado normal, pero siempre con champús suaves y sin frotar con agresividad.',
            'Se puede retomar el ejercicio moderado, pero limpiando el sudor de la frente para que no escurra hacia la zona injertada.',
            'La protección solar sigue siendo crucial. Aplicar crema SPF 50+ si hay exposición prolongada.',
            'Comienza la fase de "shock loss" (efluvio telógeno): el pelo injertado se cae. Es un proceso totalmente normal y necesario.',
            'Asegurar una dieta equilibrada rica en proteínas (carne, pescado, huevos), vitaminas (A, C, E) y minerales (hierro, zinc).',
            'Consultar con el médico la posibilidad de tomar suplementos de colágeno, queratina o biotina.',
            'Evitar por completo tintes, decoloraciones, permanentes y otros tratamientos químicos agresivos.',
            'Tomar las primeras fotografías de seguimiento para comparar la evolución en los próximos meses.',
            'Acudir a la primera consulta de revisión con la clínica.'
          ]
        },
        {
          maxDay: 60,
          phase: 'Crecimiento Inicial',
          color: '#38a169',
          tasks: [
            'Realizar masajes suaves con las yemas de los dedos en la zona receptora para estimular el riego sanguíneo (5-10 min, 2-3 veces/semana).',
            'Considerar suplementación específica para el cabello: biotina, zinc, hierro, Saw Palmetto y Omega-3, siempre bajo supervisión médica.',
            'Algunas clínicas recomiendan terapias de luz LED roja (LLLT) para acelerar el crecimiento. Consultar viabilidad.',
            'Acudir al control médico mensual para que el especialista evalúe la correcta evolución.',
            'Es un buen momento para iniciar tratamientos complementarios como el PRP (Plasma Rico en Plaquetas) si fue recomendado.',
            'La mesoterapia capilar con un cóctel de vitaminas puede ser un gran aliado en esta fase.',
            'El ejercicio regular moderado mejora la circulación general, lo que beneficia a los folículos.',
            'Practicar técnicas de relajación (yoga, meditación, mindfulness) para mantener el estrés bajo control.'
          ]
        },
        {
          maxDay: 90,
          phase: 'Desarrollo',
          color: '#3182ce',
          tasks: [
            'Los primeros cabellos nuevos (finos y cortos, como vello) empiezan a ser visibles. ¡Paciencia!',
            'Continuar con la documentación fotográfica mensual para apreciar los cambios.',
            'Usar exclusivamente productos capilares suaves: sin sulfatos, sin parabenos, sin siliconas y sin alcohol.',
            'Si el médico lo pautó, es el momento de empezar a aplicar Minoxidil tópico para fortalecer el crecimiento.',
            'El manejo del estrés es fundamental, ya que el cortisol elevado puede afectar negativamente al crecimiento del cabello.',
            'Adoptar una dieta de estilo mediterráneo: rica en verduras, frutas, legumbres, pescado azul y aceite de oliva virgen extra.',
            'Realizar un masaje semanal con aceites naturales tibios (jojoba, argán, romero) antes del lavado.',
            'Si se va a la piscina, aclarar el cabello con agua dulce inmediatamente después para eliminar el cloro.',
            'Mantener una rutina de sueño estable y de calidad (7-8 horas diarias).'
          ]
        },
        {
          maxDay: 180,
          phase: 'Consolidación',
          color: '#3182ce',
          tasks: [
            'El cabello nuevo empieza a ganar grosor y longitud. La densidad mejora notablemente.',
            'Comparar las fotografías actuales con las del inicio. Los cambios ya son evidentes.',
            'Se pueden introducir masajes con aceite de ricino (muy denso, mezclar con otro más ligero) para nutrir y fortalecer.',
            'Si se desea teñir el pelo, optar por tintes vegetales o sin amoníaco para no dañar los nuevos folículos.',
            'Realizar una analítica de sangre para comprobar niveles de ferritina, zinc, vitamina D y B12.',
            'Continuar con las sesiones de bioestimulación (PRP, mesoterapia) según el plan de tratamiento.',
            'El ejercicio cardiovascular (correr, nadar, bicicleta) es excelente para maximizar el riego sanguíneo al cuero cabelludo.',
            'Asegurar un buen aporte de vitaminas del complejo B, fundamentales para el metabolismo del folículo piloso.'
          ]
        },
        {
          maxDay: 365,
          phase: 'Maduración',
          color: '#667eea',
          tasks: [
            'El crecimiento está más consolidado y el cabello tiene un aspecto más natural y uniforme.',
            'Establecer una rutina de lavado definitiva con un champú de calidad y un acondicionador para mantener la hidratación.',
            'Si se busca un extra de densidad visual, se puede valorar la micropigmentación capilar como complemento.',
            'Ajustar la suplementación vitamínica en función de los resultados de las analíticas y la recomendación médica.',
            'Programar revisiones trimestrales con el especialista para seguir la fase final de maduración.',
            'Tomar fotografías de comparación del antes y el después del año completo.',
            'Valorar si son necesarias sesiones de mantenimiento con tratamientos como la mesoterapia.',
            'Evaluar el nivel de satisfacción con el resultado y discutir con el médico la posibilidad de futuros retoques si fueran necesarios.'
          ]
        },
        {
          maxDay: Infinity,
          phase: 'Mantenimiento',
          color: '#764ba2',
          tasks: [
            'El resultado final se alcanza entre los 12 y 18 meses. ¡A disfrutar del resultado!',
            'Mantener los hábitos saludables de higiene y nutrición de forma permanente para cuidar tanto el pelo injertado como el nativo.',
            'Consultar con el especialista ante cualquier cambio inesperado, caída masiva o irritación persistente.',
            'Se pueden usar fibras capilares o productos densificadores para ocasiones especiales si se desea un look de máxima densidad.',
            'La protección solar del cuero cabelludo debe ser un hábito para toda la vida en exposiciones prolongadas.',
            'Programar revisiones anuales para un monitoreo a largo plazo y prevenir futuros problemas.',
            'Continuar con un estilo de vida activo y un buen manejo del estrés.',
            'Si te sientes cómodo, compartir tu experiencia puede ayudar y animar a otras personas en su proceso.'
          ]
        }
      ];

      // Milestone days for progress tracking
      const milestones = [3, 10, 14, 30, 60, 90, 180, 365];

      // Initialize app
      function init() {
        updateDisplay();
        showNotification('Datos de recuperación cargados.', 'success');
      }

      function daysSince(dateStr) {
        const msPerDay = 1000 * 60 * 60 * 24;
        const implantDate = new Date(dateStr);
        const today = new Date();
        // Ajustar para que el día del implante sea el día 1
        return Math.floor((today - implantDate) / msPerDay) + 1;
      }

      function getCareForDay(day) {
        if (day < 0) return null;
        return careData.find(phase => day <= phase.maxDay);
      }

      function calculateProgress(day) {
        const maxDays = 365;
        return Math.min((day / maxDays) * 100, 100);
      }

      function getNextMilestone(day) {
        return milestones.find(milestone => day < milestone);
      }

      function showNotification(message, type = 'info') {
        const notification = createElement('div', `notification notification-${type}`);
        notification.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span>${message}</span>
            <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 1.2rem; cursor: pointer; color: inherit;">×</button>
          </div>
        `;
        
        elements.notificationContainer.appendChild(notification);
        
        // Show notification
        setTimeout(() => notification.classList.add('show'), 100);
        
        // Auto remove
        setTimeout(() => {
          notification.classList.remove('show');
          setTimeout(() => notification.remove(), 300);
        }, config.notificationDuration);
      }

      function updateStats(day) {
        const progress = calculateProgress(day);
        const nextMilestone = getNextMilestone(day);
        
        elements.daysSinceValue.textContent = day;
        elements.progressValue.textContent = `${Math.round(progress)}%`;
        elements.nextMilestoneValue.textContent = nextMilestone ? `Día ${nextMilestone}` : 'Completado';
        
        // Update progress bar
        elements.progressFill.style.width = `${progress}%`;
        elements.progressPercentage.textContent = `${Math.round(progress)}%`;
        
        // Show stats
        elements.statsGrid.style.display = 'grid';
        elements.progressContainer.style.display = 'block';
      }

      function renderCareInstructions(day, carePhase) {
        elements.outputContent.innerHTML = '';
        
        // Day title with phase badge
        const titleContainer = createElement('div', 'day-title');
        titleContainer.innerHTML = `
          📅 Día ${day}
          <span class="phase-badge" style="background-color: ${carePhase.color};">
            Fase ${carePhase.phase}
          </span>
        `;
        elements.outputContent.appendChild(titleContainer);
        
        // Care list
        const careList = createElement('ul', 'care-list');
        carePhase.tasks.forEach((task, index) => {
          const listItem = createElement('li', 'care-item');
          listItem.innerHTML = `
            <div class="care-icon">${index + 1}</div>
            <div class="care-text">${task}</div>
          `;
          careList.appendChild(listItem);
        });
        elements.outputContent.appendChild(careList);
        
        // Next milestone info
        const nextMilestone = getNextMilestone(day);
        if (nextMilestone) {
          const daysToMilestone = nextMilestone - day;
          const milestoneEl = createElement('div', 'milestone');

          milestoneEl.textContent = `⏰ Faltan ${daysToMilestone} día${daysToMilestone !== 1 ? 's' : ''} para el próximo hito (día ${nextMilestone})`;
          elements.outputContent.appendChild(milestoneEl);
        } else {
          const completedEl = createElement('div', 'milestone');
          completedEl.textContent = '🎉 ¡Felicitaciones! Has completado las fases principales de recuperación';
          elements.outputContent.appendChild(completedEl);
        }
      }

      function updateDisplay() {
        const day = daysSince(elements.dateInput.value);
        const carePhase = getCareForDay(day);
        
        if (!carePhase) {
          showNotification('Fecha inválida. Por favor selecciona una fecha válida.', 'error');
          return;
        }
        
        updateStats(day);
        renderCareInstructions(day, carePhase);
        
        // Show output card with animation
        elements.outputCard.style.display = 'block';
        elements.outputCard.classList.add('fade-in');
      }

      // Initialize app when DOM is loaded
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }

      // Service Worker registration for PWA functionality
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('data:application/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4ge2V2ZW50LndhaXRVbnRpbChzZWxmLnNraXBXYWl0aW5nKCkpO30pO3NlbGYuYWRkRXZlbnRMaXN0ZW5lcignYWN0aXZhdGUnLCBldmVudCA9PiB7ZXZlbnQud2FpdFVudGlsKHNlbGYuY2xpZW50cy5jbGFpbSgpKTt9KTs=')
            .then(() => console.log('SW registered'))
            .catch(() => console.log('SW registration failed'));
        });
      }

    })();
  </script>
</body>
</html>
