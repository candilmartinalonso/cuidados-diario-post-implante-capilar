<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplicación web para el seguimiento de cuidados post implante capilar con un diseño limpio y moderno.">
    <meta name="keywords" content="implante capilar, cuidados post operatorios, recuperación, seguimiento, hair transplant">
    <meta name="author" content="Gemini AI Optimization">
    <title>Cuidados del Pelo - Seguimiento Post Implante</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMDBjNmZmOyIgLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDdiYmU7IiAvPjwvbGluZWFyR3JhZGllbnQ+PHJlY3Qgd2lkdGg9IjEyOCIgaGVpZ2h0PSIxMjgiIHJ4PSIyNCIgZmlsbD0idXJsKCNncmFkKSIgLz48cGF0aCBmaWxsPSJ3aGl0ZSIgZD0iTTgwLjMsNDYuNmMxLjUtMS44LDMuOS0yLjksNi44LTIuOWMyLjUsMCw0LjksMS4xLDYuNCwyLjljMy4zLDQuMSwzLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjNCMSwzLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjMsMC45Yy0wLjIsMC41LTAuNCwxLTAuNiwxLjVjLTEuOSw0LjktNi40LDguNS0xMS43LDkuMmMtMC41LDAtMSwwLjEtMS41LDAuMWMtNS4zLDAuNy0xMC40LTEuOC0xMy4zLTYuMWMtMC43LTEtMS4zLTIuMS0xLjgtMy4zYy0wLjctMS42LTEuMS0zLjMtMS4xLTQuOWMwLTIuNSwxLTUsMi42LTdjMS4zLTEuNywzLTNsNC41LTMuNmMxLjgtMS4xLDMuNy0yLDQuOC0zLjRjMS4xLTEuNCwxLjctMywyLjEtNC44YzAuMy0xLjMsMC41LTIuNywwLjUtNC4xYzAtMS41LTAuMi0zLTAuOC00LjRjLTEuMy0zLjItNC4yLTUuNS03LjctNS45Yy0zLjUtMC40LTYuOSwxLjEtOC44LDMuOWMtMC42LDAuOS0xLjEsMS45LTEuNCwzYy0wLjEsMC40LTAuMSwwLjktMC4xLDEuM3MwLDIuMSwwLjgsNC4xLDIuMiw1LjZjMS4xLDEuMiwxLjgsMS45LDIuOSwyLjljMS4xLDEsMi4xLDEuNSwzLjEsMi4xYzAuMywwLjIsMC41LDAuMywwLjgsMC41YzEuOCwxLjEsMy4zLDIuNyw0LjMsNC41YzAuNSwwLjksMC44LDEuOSwwLjksMi45YzAuMSwxLjUtMC4xLDMtMC41LDQuNGMtMC45LDMuMy0zLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjMsMC45Yy0wLjIsMC41LTAuNCwxLTAuNiwxLjVjLTEuOSw0LjktNi40LDguNS0xMS43LDkuMmMtMC41LDAtMSwwLjEtMS41LDAuMWMtNS4zLDAuNy0xMC40LTEuOC0xMy4zLTYuMWMtMC43LTEtMS4zLTIuMS0xLjgtMy4zYy0wLjctMS42LTEuMS0zLjdtLTQuOWMwLTIuNSwxLTUsMi42LTdjMS4zLTEuNywzLTNsNC41LTMuNmMxLjgtMS4xLDMuNy0yLDQuOC0zLjRjMS4xLTEuNCwxLjctMywyLjEtNC44YzAuMy0xLjMsMC41LTIuNywwLjUtNC4xYzAtMS41LTAuMi0zLTAuOC00LjRjLTEuMy0zLjItNC4yLTUuNS07LjctNS45Yy0zLjUtMC40LTYuOSwxLjEtOC44LDMuOWMtMC42LDAuOS0xLjEsMS45LTEuNCwzYy0wLjEsMC40LTAuMSwwLjktMC4xLDEuM2MwLDIuMSwwLjgsNC4xLDIuMiw1LjZjMS4xLDEuMiwxLjgsMS45LDIuOSwyLjljMS4xLDEsMi4xLDEuNSwzLjEsMi4xYzAuMywwLjIsMC41LDAuMywwLjgsMC41YzEuOCwxLjEsMy4zLDIuNyw0LjMsNC41YzAuNSwwLjksMC44LDEuOSwwLjksMi45YzAuMSwxLjUtMC4xLDMtMC41LDQuNGMtMC45LDMuMy0zLjUsNS44LTYuOCw2LjVjLTAuMywwLTAuNywwLjEtMSwwLjFjLTMuMywwLjctNi41LTAuOS04LjYtMy44Yy0xLjYtMS45LTIuNi00LjMtMi4xLTYuOWMwLTEuNSwwLjMtMywwLjktNC40YzAuNC0xLDEtMS45LDEuNi0yLjdjMC4yLTAuMywwLjUtMC41LDAuNy0wLjhsMC4xLTAuMmMwLjEtMC4xLDAuMi0wLjIsMC4yLTAuM2MwLjMtMC40LDAuMy0xLTAuMS0xLjNjLTAuNC0wLjMtMS0wLjMtMS4zLDAuMWMtMC4xLDAuMS0wLjIsMC4yLTAuMywwLjNjLTAuMSwwLjEtMC4yLDAuMi0wLjMsMC4zYy0wLjgsMS0xLjUsMi0yLjEsMy4xYy0wLjcsMS4yLTEsMi41LTEsMy45YzAsMy4xLDEuMiw2LDMuMyw4LjJjMi44LDMsNi44LDQuOCwxMSw0LjNjMC40LDAsMC44LDAsMS4yLTAuMWM0LjItMC45LDcuOC0zLjgsOS40LTcuOGMwLjUtMS4zLDAuOC0yLjcsMC44LTQuMWMwLTEtMC4yLTIuMS0wLjYtMy4xYy0wLjEtMC4zLTAuMy0wLjYtMC40LTAuOWMtMC4zLTAuOC0wLjctMS42LTEuMi0yLjNjLTEuMy0yLTIuOS0zLjYtNC44LTQuN2MtMC40LTAuMi0wLjgtMC41LTEuMi0wLjdjLTEuMi0wLjctMi40LTEuMy0zLjYtMi4xYy0xLjQtMS0yLjQtMS41LTMuNi0yLjRjLTIuMy0xLjctMy45LTMuOS00LjYtNi42Yy0wLjQtMS41LTAuNC0zLjEtMC4xLTQuNmMwLjYtMy4xLDMuMS01LjYsNi4xLTYuMWMzLTAuNSw2LDEsNy45LDMuM2MwLjUsMC42LDEsMS4zLDEuMywxLjljMC4xLDAuMywwLjIsMC41LDAuMywwLjljMC4xLDAuMiwwLjEsMC40LDAuMSwwLjZjMCwxLjQtMC40LDIuOC0xLjMsNC4xYy0wLjcsMS0xLjUsMS44LTIuNSwyLjRjLTEuMywwLjktMi44LDEuNS0zLjUsMi43Yy0wLjgsMS4yLTEuMSwyLjYtMC44LDMuOWMwLjIsMSwwLjcsMS45LDEuNCwyLjdjMi4yLDIsNS42LDIsNy44LDBjMi4yLTIsMi4yLTUuMywwLTcuM0w4MC4zLDQ2LjZ6Ii8+PC9zdmc+">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent-primary: #007bff;
            --accent-primary-light: #e6f2ff;
            --accent-success: #28a745;
            --border-color: #dee2e6;
            --shadow-color: rgba(0, 123, 255, 0.1);
            --radius-lg: 0.75rem;
            --font-sans: 'Inter', sans-serif;
            --font-mono: 'Roboto Mono', monospace;
            --transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            --mouse-x: 50%;
            --mouse-y: 50%;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, #e6f2ff, #f8f9fa, #fff);
            background-size: 400% 400%;
            animation: gradient-bg 20s ease infinite;
            color: var(--text-primary);
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }
        
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 3rem 1rem;
        }

        .app-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .app-title {
            font-size: clamp(2.5rem, 6vw, 3.5rem);
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        .app-title span {
            display: inline-block;
            opacity: 0;
            transform: translateY(-20px) scale(0.9);
            animation: letter-reveal 0.8s cubic-bezier(0.2, 1, 0.3, 1) forwards;
        }
        
        .app-subtitle {
            font-size: 1.15rem;
            color: var(--text-secondary);
            max-width: 500px;
            margin: 0 auto;
            animation: slide-up 0.8s 0.4s cubic-bezier(0.2, 1, 0.3, 1) forwards;
            opacity: 0;
        }

        .stats-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            box-shadow: 0 8px 25px var(--shadow-color);
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            animation: fade-in-up 0.8s 0.6s forwards;
            opacity: 0;
            transition: transform var(--transition), box-shadow var(--transition);
            position: relative;
            overflow: hidden;
        }
        .stats-card:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: 0 12px 30px var(--shadow-color);
        }
        /* Shine effect */
        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(255,255,255,0.4), transparent 80%);
            transform: translate(var(--mouse-x), var(--mouse-y));
            opacity: 0;
            transition: opacity 0.3s;
        }
        .stats-card:hover::before {
            opacity: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--accent-primary);
            line-height: 1.2;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }
        .stat-value.stat-text {
            font-family: var(--font-sans);
        }
        /* Odometer effect */
        .digit-roller {
            display: inline-block;
            height: 2.2rem;
            line-height: 2.2rem;
        }
        .digit-roller > span {
            display: block;
            transition: transform 1.5s cubic-bezier(0.2, 1, 0.3, 1);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .timeline-container {
            position: relative;
        }

        .timeline {
            position: relative;
            padding: 1rem 0 1rem 1.5rem;
            border-left: 3px solid var(--border-color);
        }
        
        .timeline-progress {
            position: absolute;
            left: -3px;
            top: 0;
            width: 3px;
            background: var(--accent-primary);
            border-radius: 2px;
            transition: height 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            height: 0;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 2.5rem;
            opacity: 0;
            transform: translateX(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }
        .timeline-item.is-visible {
            opacity: 1;
            transform: translateX(0);
        }
        .timeline-item:last-child { margin-bottom: 0; }
        
        .timeline-dot {
            position: absolute;
            left: -2.2rem;
            top: 5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid var(--border-color);
            background-color: var(--bg-primary);
            transition: all var(--transition);
            z-index: 2;
        }
        
        .timeline-item.active .timeline-dot {
            background-color: var(--accent-primary);
            border-color: var(--accent-primary);
            transform: scale(1.2);
            box-shadow: 0 0 15px var(--accent-primary-light);
            animation: pulse-glow 2s infinite ease-in-out;
        }
        .timeline-item.completed .timeline-dot {
            background-color: var(--accent-success);
            border-color: var(--accent-success);
        }
        
        .timeline-content {
            background-color: transparent;
            padding: 0;
        }
        
        .timeline-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .timeline-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .timeline-phase {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.2rem 0.6rem;
            border-radius: 2rem;
            color: var(--accent-primary);
            background-color: var(--accent-primary-light);
            transition: all var(--transition);
        }
        .timeline-item:hover .timeline-phase {
            transform: scale(1.05);
            box-shadow: 0 2px 10px var(--shadow-color);
        }
        
        .care-list { 
            list-style: none; 
            margin-top: 1rem;
            padding-left: 0;
        }
        .care-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.4rem 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
            opacity: 0;
            transform: translateX(-10px);
            animation: fade-in-item 0.5s forwards;
        }
        .care-icon {
            flex-shrink: 0;
            width: 20px;
            height: 20px;
            margin-top: 4px;
            color: var(--accent-success);
        }
        .care-icon path {
            stroke-dasharray: 24;
            stroke-dashoffset: 24;
            animation: draw-check 0.8s 0.5s ease-out forwards;
        }
        
        .notification {
            position: fixed;
            bottom: 1.5rem;
            left: 50%;
            transform: translateX(-50%) translateY(200%);
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-lg);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            border-left: 5px solid var(--accent-primary);
            opacity: 0;
        }
        .notification.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* --- ANIMATIONS --- */
        @keyframes gradient-bg {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes letter-reveal {
            to { transform: translateY(0) scale(1); opacity: 1; }
        }
        @keyframes slide-down {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes slide-up {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes fade-in-item {
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 15px var(--accent-primary-light); }
            50% { box-shadow: 0 0 25px var(--accent-primary-light); }
        }
        @keyframes draw-check {
            to { stroke-dashoffset: 0; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1 class="app-title"></h1>
            <p class="app-subtitle">Tu asistente personal para una recuperación capilar exitosa.</p>
        </header>

        <main id="dashboard">
            <div class="stats-card">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div id="implantDateValue" class="stat-value stat-text">-</div>
                        <div class="stat-label">Fecha de Injerto</div>
                    </div>
                    <div class="stat-item">
                        <div id="daysSinceValue" class="stat-value">0</div>
                        <div class="stat-label">Días Transcurridos</div>
                    </div>
                    <div class="stat-item">
                        <div id="progressValue" class="stat-value">0%</div>
                        <div class="stat-label">Recuperación</div>
                    </div>
                    <div class="stat-item">
                        <div id="nextMilestoneValue" class="stat-value stat-text">-</div>
                        <div class="stat-label">Próximo Hito</div>
                    </div>
                </div>
            </div>

            <div class="timeline-container">
                <div class="timeline">
                    <div id="timelineProgress" class="timeline-progress"></div>
                    <div id="timeline-items"></div>
                </div>
            </div>
        </main>
    </div>

    <div id="notificationContainer"></div>

    <script>
    (() => {
        'use strict';

        const FIXED_IMPLANT_DATE = '2025-06-04';
        const MAX_RECOVERY_DAYS = 365;
        const careData = [
            { day: 1, phase: 'Crítica', title: 'Días 1-3: Fase Crítica', tasks: [ 'No tocar, rascar ni frotar la zona injertada.', 'Dormir semi-sentado (45°) para minimizar hinchazón.', 'Pulverizar suero fisiológico cada 1-2 horas.', 'Evitar sol, calor, polvo y gorras ajustadas.', 'Seguir pauta de medicación.', 'Beber 2-3 litros de agua al día.', 'Reposo absoluto, no agacharse ni levantar peso.', 'Prohibido alcohol, tabaco y cafeína.' ] },
            { day: 4, phase: 'Inicial', title: 'Días 4-10: Caída de Costras', tasks: [ 'Realizar primer lavado según instrucciones de la clínica (toques suaves).', 'Las costras caerán solas, no arrancarlas.', 'Evitar peines y camisetas de cuello estrecho.', 'Abstinencia total de alcohol y tabaco.', 'Prohibido piscinas, mar o saunas.', 'Aplicar productos post-operatorios recomendados.', 'Continuar durmiendo con cabeza elevada.', 'Evitar cualquier tipo de ejercicio físico.' ] },
            { day: 11, phase: 'Recuperación', title: 'Días 11-30: Shock Loss', tasks: [ 'Lavar diariamente con yemas de los dedos, movimientos suaves.', 'Se puede usar gorras holgadas para proteger del sol.', 'Iniciar ejercicio muy ligero (paseos).', 'Comienza la fase de "shock loss" (caída del pelo injertado), es normal.', 'Dieta rica en proteínas, vitaminas y minerales.', 'Acudir a la primera revisión en la clínica.', 'No usar tintes ni tratamientos químicos.' ] },
            { day: 31, phase: 'Crecimiento', title: 'Meses 1-3: Primeros Brotes', tasks: [ 'Los primeros cabellos nuevos (finos y cortos) empiezan a ser visibles.', 'Realizar masajes suaves en la zona receptora para estimular circulación.', 'Considerar tratamientos como PRP o mesoterapia si se recomendó.', 'Usar productos capilares suaves (sin sulfatos, parabenos, siliconas).', 'Empezar a aplicar Minoxidil si fue pautado por el médico.', 'Controlar el estrés, es crucial para el crecimiento.' ] },
            { day: 91, phase: 'Consolidación', title: 'Meses 3-6: Aumento de Densidad', tasks: [ 'El cabello nuevo gana grosor y longitud. La densidad mejora.', 'Se puede teñir el pelo con tintes vegetales o sin amoníaco.', 'Realizar analítica de sangre para comprobar niveles de vitaminas.', 'El ejercicio cardiovascular es excelente para el riego sanguíneo.', 'Continuar con las sesiones de bioestimulación (PRP).' ] },
            { day: 181, phase: 'Maduración', title: 'Meses 6-12: Resultado Visible', tasks: [ 'El crecimiento está consolidado, el aspecto es más natural.', 'Establecer una rutina de lavado definitiva con productos de calidad.', 'Evaluar el resultado y discutir con el médico si se necesitan retoques.', 'Programar revisiones trimestrales con el especialista.', 'Comparar las fotos del año completo. ¡Disfruta del cambio!' ] },
            { day: 366, phase: 'Mantenimiento', title: 'Año 1+: Cuidado a Largo Plazo', tasks: [ 'El resultado final se alcanza entre los 12 y 18 meses.', 'Mantener hábitos saludables de higiene y nutrición.', 'La protección solar del cuero cabelludo debe ser un hábito.', 'Programar revisiones anuales para monitoreo a largo plazo.' ] }
        ];

        const $ = (selector) => document.querySelector(selector);
        const elements = {
            appTitle: $('.app-title'),
            statsCard: $('.stats-card'),
            implantDateValue: $('#implantDateValue'),
            daysSinceValue: $('#daysSinceValue'),
            progressValue: $('#progressValue'),
            nextMilestoneValue: $('#nextMilestoneValue'),
            timelineItemsContainer: $('#timeline-items'),
            timelineProgress: $('#timelineProgress'),
            notificationContainer: $('#notificationContainer'),
        };

        const App = {
            init() {
                this.setupAnimatedTitle('Cuidados del Pelo');
                this.renderDashboard(FIXED_IMPLANT_DATE);
                this.setupScrollObserver();
                this.setupMouseEffects();
                this.showNotification('Guía de cuidados cargada.');
            },
            
            animateOdometer(element, finalValue, isPercentage = false) {
                const finalString = String(finalValue) + (isPercentage ? '%' : '');
                element.innerHTML = ''; // Clear previous content

                Array.from(finalString).forEach(char => {
                    const digitContainer = document.createElement('div');
                    digitContainer.className = 'digit-roller';
                    
                    const isNum = !isNaN(parseInt(char));
                    
                    const innerSpan = document.createElement('span');
                    
                    if (isNum) {
                        for(let i = 0; i <= 9; i++) {
                            const d = document.createElement('div');
                            d.textContent = i;
                            innerSpan.appendChild(d);
                        }
                    } else {
                        const d = document.createElement('div');
                        d.textContent = char;
                        innerSpan.appendChild(d);
                    }

                    digitContainer.appendChild(innerSpan);
                    element.appendChild(digitContainer);

                    setTimeout(() => {
                        const targetIndex = isNum ? parseInt(char) : 0;
                        const offset = -targetIndex * digitContainer.clientHeight;
                        innerSpan.style.transform = `translateY(${offset}px)`;
                    }, 100);
                });
            },

            renderDashboard(dateStr) {
                const [year, month, day] = dateStr.split('-').map(Number);
                const implantDate = new Date(Date.UTC(year, month - 1, day));
                const today = new Date();
                const todayUtc = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));
                const diffTime = todayUtc - implantDate;

                const daysForDisplay = Math.max(0, Math.floor(diffTime / (1000 * 60 * 60 * 24)));
                const dayForLogic = daysForDisplay + 1;

                elements.implantDateValue.textContent = implantDate.toLocaleDateString('es-ES', { year: 'numeric', month: 'short', day: 'numeric', timeZone: 'UTC' });
                const progress = Math.round(Math.min((dayForLogic / MAX_RECOVERY_DAYS) * 100, 100));
                
                this.animateOdometer(elements.daysSinceValue, daysForDisplay);
                this.animateOdometer(elements.progressValue, progress, true);

                const nextMilestone = careData.find(phase => dayForLogic < phase.day);
                elements.nextMilestoneValue.textContent = nextMilestone ? `Día ${nextMilestone.day}` : 'Finalizado';
                this.renderTimeline(dayForLogic);
            },

            renderTimeline(currentDay) {
                elements.timelineItemsContainer.innerHTML = '';
                careData.forEach((phase) => {
                    const isActive = currentDay >= phase.day && (careData.find(p => p.day > phase.day) ? currentDay < careData.find(p => p.day > phase.day).day : true);
                    const isCompleted = careData.find(p => p.day > phase.day) ? currentDay >= careData.find(p => p.day > phase.day).day : currentDay > phase.day;

                    const item = document.createElement('div');
                    item.className = `timeline-item ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''}`;
                    
                    let careListHTML = isActive ? `<ul class="care-list">${phase.tasks.map((task, index) => `
                        <li class="care-item" style="animation-delay: ${index * 100}ms">
                            <svg class="care-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>
                            <span>${task}</span>
                        </li>`).join('')}</ul>` : '';
                    
                    item.innerHTML = `
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-header">
                                <h3 class="timeline-title">${phase.title}</h3>
                                <span class="timeline-phase">${phase.phase}</span>
                            </div>
                            ${careListHTML}
                        </div>`;
                    elements.timelineItemsContainer.appendChild(item);
                });
                
                setTimeout(() => {
                    const activeItem = elements.timelineItemsContainer.querySelector('.timeline-item.active');
                    let progressHeight = 0;

                    if (activeItem) {
                        progressHeight = activeItem.offsetTop + 10; 
                    } else {
                        const completedItems = elements.timelineItemsContainer.querySelectorAll('.timeline-item.completed');
                        if (completedItems.length === careData.length) {
                            progressHeight = elements.timelineItemsContainer.parentElement.offsetHeight;
                        }
                    }
                    
                    elements.timelineProgress.style.height = `${progressHeight}px`;
                }, 200);
            },

            setupAnimatedTitle(title) {
                const titleElement = elements.appTitle;
                titleElement.innerHTML = title.split('').map((letter, index) => 
                    `<span style="animation-delay: ${index * 50}ms">${letter === ' ' ? '&nbsp;' : letter}</span>`
                ).join('');
            },

            setupScrollObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry, index) => {
                        if (entry.isIntersecting) {
                            entry.target.style.transitionDelay = `${index * 100}ms`;
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('.timeline-item').forEach(item => {
                    observer.observe(item);
                });
            },

            setupMouseEffects() {
                const card = elements.statsCard;
                if (!card) return;
                card.addEventListener('mousemove', e => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    card.style.setProperty('--mouse-x', `${x - 75}px`);
                    card.style.setProperty('--mouse-y', `${y - 75}px`);
                });
            },

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.textContent = message;
                elements.notificationContainer.appendChild(notification);
                setTimeout(() => notification.classList.add('show'), 100);
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 600);
                }, 4000);
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    })();
    </script>
</body>
</html>
