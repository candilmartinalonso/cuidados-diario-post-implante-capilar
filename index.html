<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplicaci√≥n web para el seguimiento de cuidados post implante capilar con progreso visual y gu√≠as detalladas.">
    <meta name="keywords" content="implante capilar, cuidados post operatorios, recuperaci√≥n, seguimiento, hair transplant">
    <meta name="author" content="Gemini AI Optimization">
    <title>Cuidados del Pelo - Seguimiento Post Implante</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojOGI1Y2ZmOyIgLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NjRiYTI7IiAvPjwvbGluZWFyR3JhZGllbnQ+PHJlY3Qgd2lkdGg9IjEyOCIgaGVpZ2h0PSIxMjgiIHJ4PSIyNCIgZmlsbD0idXJsKCNncmFkKSIgLz48cGF0aCBmaWxsPSJ3aGl0ZSIgZD0iTTgwLjMsNDYuNmMxLjUtMS44LDMuOS0yLjksNi40LTIuOWMyLjUsMCw0LjksMS4xLDYuNCwyLjljMy4zLDQuMSwzLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjNCMSwzLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjMsMC45Yy0wLjIsMC41LTAuNCwxLTAuNiwxLjVjLTEuOSw0LjktNi40LDguNS0xMS43LDkuMmMtMC41LDAtMSwwLjEtMS41LDAuMWMtNS4zLDAuNy0xMC40LTEuOC0xMy4zLTYuMWMtMC43LTEtMS4zLTIuMS0xLjgtMy4zYy0wLjctMS42LTEuMS0zLjMtMS4xLTQuOWMwLTIuNSwxLTUsMi42LTdjMS4zLTEuNywzLTNsNC41LTMuNmMxLjgtMS4xLDMuNy0yLDQuOC0zLjRjMS4xLTEuNCwxLjctMywyLjEtNC44YzAuMy0xLjMsMC41LTIuNywwLjUtNC4xYzAtMS41LTAuMi0zLTAuOC00LjRjLTEuMy0zLjItNC4yLTUuNS03LjctNS45Yy0zLjUtMC40LTYuOSwxLjEtOC44LDMuOWMtMC42LDAuOS0xLjEsMS45LTEuNCwzYy0wLjEsMC40LTAuMSwwLjktMC4xLDEuM2MwLDIuMSwwLjgsNC4xLDIuMiw1LjZjMS4xLDEuMiwxLjgsMS45LDIuOSwyLjljMS4xLDEsMi4xLDEuNSwzLjEsMi4xYzAuMywwLjIsMC41LDAuMywwLjgsMC41YzEuOCwxLjEsMy4zLDIuNyw0LjMsNC41YzAuNSwwLjksMC44LDEuOSwwLjksMi45YzAuMSwxLjUtMC4xLDMtMC41LDQuNGMtMC45LDMuMy0zLjEsMTAuMi0wLjUsMTQuMmMtMS4yLDEuMy0yLjYsMi4zLTMuOSwzLjFjLTAuMSwwLjMtMC4yLDAuNi0wLjMsMC45Yy0wLjIsMC41LTAuNCwxLTAuNiwxLjVjLTEuOSw0LjktNi40LDguNS0xMS43LDkuMmMtMC41LDAtMSwwLjEtMS41LDAuMWMtNS4zLDAuNy0xMC40LTEuOC0xMy4zLTYuMWMtMC43LTEtMS4zLTIuMS0xLjgtMy4zYy0wLjctMS42LTEuMS0zLjMtMS4xLTQuOWMwLTIuNSwxLTUsMi42LTdjMS4zLTEuNywzLTNsNC41LTMuNmMxLjgtMS4xLDMuNy0yLDQuOC0zLjRjMS4xLTEuNCwxLjctMywyLjEtNC44YzAuMy0xLjMsMC41LTIuNywwLjUtNC4xYzAtMS41LTAuMi0zLTAuOC00LjRjLTEuMy0zLjItNC4yLTUuNS03LjctNS45Yy0zLjUtMC40LTYuOSwxLjEtOC44LDMuOWMtMC42LDAuOS0xLjEsMS45LTEuNCwzYy0wLjEsMC40LTAuMSwwLjktMC4xLDEuM2MwLDIuMSwwLjgsNC4xLDIuMiw1LjZjMS4xLDEuMiwxLjgsMS45LDIuOSwyLjljMS4xLDEsMi4xLDEuNSwzLjEsMi4xYzAuMywwLjIsMC41LDAuMywwLjgsMC41YzEuOCwxLjEsMy4zLDIuNyw0LjMsNC41YzAuNSwwLjksMC44LDEuOSwwLjksMi45YzAuMSwxLjUtMC4xLDMtMC41LDQuNGMtMC45LDMuMy0zLjUsNS44LTYuOCw2LjVjLTAuMywwLTAuNywwLjEtMSwwLjFjLTMuMywwLjctNi41LTAuOS04LjYtMy40Yy0xLjYtMS45LTIuNi00LjMtMi42LTYuOWMwLTEuNSwwLjMtMywwLjktNC40YzAuNC0xLDEtMS45LDEuNi0yLjdjMC4yLTAuMywwLjUtMC41LDAuNy0wLjhsMC4xLTAuMmMwLjEtMC4xLDAuMi0wLjIsMC4yLTAuM2MwLjMtMC40LDAuMy0xLTAuMS0xLjNjLTAuNC0wLjMtMS0wLjMtMS4zLDAuMWMtMC4xLDAuMS0wLjIsMC4yLTAuMywwLjNjLTAuMSwwLjEtMC4yLDAuMi0wLjMsMC4zYy0wLjgsMS0xLjUsMi0yLjEsMy4xYy0wLjcsMS4yLTEsMi41LTEsMy45YzAsMy4xLDEuMiw2LDMuMyw4LjJjMi44LDMsNi44LDQuOCwxMSw0LjNjMC40LDAsMC44LDAsMS4yLTAuMWM0LjItMC45LDcuOC0zLjgsOS40LTcuOGMwLjUtMS4zLDAuOC0yLjcsMC44LTQuMWMwLTEtMC4yLTIuMS0wLjYtMy4xYy0wLjEtMC4zLTAuMy0wLjYtMC40LTAuOWMtMC4zLTAuOC0wLjctMS42LTEuMi0yLjNjLTEuMy0yLTIuOS0zLjYtNC44LTQuN2MtMC40LTAuMi0wLjgtMC41LTEuMi0wLjdjLTEuMi0wLjctMi40LTEuMy0zLjYtMi4xYy0xLjQtMS0yLjQtMS41LTMuNi0yLjRjLTIuMy0xLjctMy45LTMuOS00LjYtNi42Yy0wLjQtMS41LTAuNC0zLjEtMC4xLTQuNmMwLjYtMy4xLDMuMS01LjYsNi4xLTYuMWMzLTAuNSw2LDEsNy45LDMuM2MwLjUsMC42LDEsMS4zLDEuMywxLjljMC4xLDAuMywwLjIsMC41LDAuMywwLjljMC4xLDAuMiwwLjEsMC40LDAuMSwwLjZjMCwxLjQtMC40LDIuOC0xLjMsNC4xYy0wLjcsMS0xLjUsMS44LTIuNSwyLjRjLTEuMywwLjktMi44LDEuNS0zLjUsMi43Yy0wLjgsMS4yLTEuMSwyLjYtMC44LDMuOWMwLjIsMSwwLjcsMS45LDEuNCwyLjdjMi4yLDIsNS42LDIsNy44LDBjMi4yLTIsMi4yLTUuMywwLTcuM0w4MC4zLDQ2LjZ6Ii8+PC9zdmc+">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #11111b;
            --bg-secondary: #1e1e2e;
            --bg-card: #181825;
            --bg-gradient: linear-gradient(135deg, #8b5cff 0%, #764ba2 100%);
            --text-primary: #cdd6f4;
            --text-secondary: #a6adc8;
            --text-muted: #6c7086;
            --accent-primary: #8b5cff;
            --accent-secondary: #cba6f7;
            --accent-success: #a6e3a1;
            --accent-warning: #f9e2af;
            --accent-error: #f38ba8;
            --accent-info: #89b4fa;
            --border-color: rgba(148, 163, 184, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.2);
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --font-sans: 'Inter', sans-serif;
            --font-mono: 'Roboto Mono', monospace;
            --transition: 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }

        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .app-header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .app-title {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            background: var(--bg-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.5rem;
        }

        .app-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        .card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-bottom: 1.5rem;
            transition: transform var(--transition), box-shadow var(--transition);
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px var(--shadow-color);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .card-content {
            padding: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }
        .stat-item {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--radius-md);
            text-align: center;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--accent-primary);
            line-height: 1.2;
        }
        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .timeline {
            position: relative;
            padding: 1rem 0;
        }
        .timeline-line {
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: var(--bg-secondary);
            border-radius: 2px;
        }
        .timeline-progress {
            position: absolute;
            left: 12px;
            top: 0;
            width: 4px;
            background: var(--bg-gradient);
            border-radius: 2px;
            transition: height 1s var(--transition);
        }
        .timeline-item {
            position: relative;
            padding-left: 40px;
            margin-bottom: 1.5rem;
        }
        .timeline-item:last-child { margin-bottom: 0; }
        .timeline-dot {
            position: absolute;
            left: 0;
            top: 0;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 4px solid var(--bg-secondary);
            background-color: var(--bg-card);
            transition: var(--transition);
        }
        .timeline-item.active .timeline-dot {
            background-color: var(--accent-primary);
            border-color: var(--accent-primary);
            transform: scale(1.1);
        }
        .timeline-item.completed .timeline-dot {
            background-color: var(--accent-success);
            border-color: var(--accent-success);
        }
        .timeline-content {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--radius-md);
        }
        .timeline-title {
            font-weight: 600;
            color: var(--text-primary);
        }
        .timeline-phase {
            font-size: 0.8rem;
            font-weight: 500;
            padding: 0.2rem 0.5rem;
            border-radius: 0.5rem;
            color: white;
            display: inline-block;
            margin-left: 0.5rem;
        }

        .care-list {
            list-style: none;
            margin-top: 1rem;
        }
        .care-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }
        .care-icon {
            flex-shrink: 0;
            width: 20px;
            height: 20px;
            margin-top: 4px;
            color: var(--accent-info);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .notification {
            position: fixed;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%) translateY(200%);
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-md);
            box-shadow: 0 5px 15px var(--shadow-color);
            z-index: 1000;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            border-left: 4px solid;
        }
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        .notification-success { border-color: var(--accent-success); }
        .notification-error { border-color: var(--accent-error); }
        .notification-info { border-color: var(--accent-info); }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1 class="app-title">Cuidados del Pelo</h1>
            <p class="app-subtitle">Tu asistente personal para una recuperaci√≥n capilar exitosa.</p>
        </header>

        <!-- Main Dashboard (visible by default) -->
        <main id="dashboard">
            <!-- Stats Card -->
            <div class="card fade-in">
                <div class="card-header">
                    <h2 class="card-title">üìà Tu Progreso</h2>
                    <!-- Reset button removed -->
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div id="implantDateValue" class="stat-value" style="font-size: 1.25rem; color: var(--accent-info);">-</div>
                            <div class="stat-label">Fecha de Injerto</div>
                        </div>
                        <div class="stat-item">
                            <div id="daysSinceValue" class="stat-value">-</div>
                            <div class="stat-label">D√≠as Transcurridos</div>
                        </div>
                        <div class="stat-item">
                            <div id="progressValue" class="stat-value">-</div>
                            <div class="stat-label">Recuperaci√≥n</div>
                        </div>
                        <div class="stat-item">
                            <div id="nextMilestoneValue" class="stat-value">-</div>
                            <div class="stat-label">Pr√≥ximo Hito</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Timeline Card -->
            <div class="card fade-in">
                <div class="card-header">
                    <h2 class="card-title">üóìÔ∏è L√≠nea de Tiempo de Recuperaci√≥n</h2>
                </div>
                <div class="card-content">
                    <div class="timeline">
                        <div class="timeline-line"></div>
                        <div id="timelineProgress" class="timeline-progress"></div>
                        <div id="timeline-container">
                            <!-- Timeline items will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="notificationContainer"></div>

    <script>
    (() => {
        'use strict';

        // --- CONFIGURATION & DATA ---
        const FIXED_IMPLANT_DATE = '2025-06-04';
        const MAX_RECOVERY_DAYS = 365;

        const careData = [
            { day: 1, maxDay: 3, phase: 'Cr√≠tica', color: '#f38ba8', title: 'D√≠as 1-3: Fase Cr√≠tica', tasks: [ 'No tocar, rascar ni frotar la zona injertada.', 'Dormir semi-sentado (45¬∞) para minimizar hinchaz√≥n.', 'Pulverizar suero fisiol√≥gico cada 1-2 horas.', 'Evitar sol, calor, polvo y gorras ajustadas.', 'Seguir pauta de medicaci√≥n (antibi√≥ticos, antiinflamatorios).', 'Beber 2-3 litros de agua al d√≠a.', 'Reposo absoluto, no agacharse ni levantar peso.', 'Prohibido alcohol, tabaco y cafe√≠na.' ] },
            { day: 4, maxDay: 10, phase: 'Inicial', color: '#f9e2af', title: 'D√≠as 4-10: Ca√≠da de Costras', tasks: [ 'Realizar primer lavado seg√∫n instrucciones de la cl√≠nica (toques suaves).', 'Las costras caer√°n solas, no arrancarlas.', 'Evitar peines y camisetas de cuello estrecho.', 'Abstinencia total de alcohol y tabaco.', 'Prohibido piscinas, mar o saunas.', 'Aplicar productos post-operatorios recomendados.', 'Continuar durmiendo con cabeza elevada.', 'Evitar cualquier tipo de ejercicio f√≠sico.' ] },
            { day: 11, maxDay: 30, phase: 'Recuperaci√≥n', color: '#a6e3a1', title: 'D√≠as 11-30: Shock Loss', tasks: [ 'Lavar diariamente con yemas de los dedos, movimientos suaves.', 'Se puede usar gorras holgadas para proteger del sol.', 'Iniciar ejercicio muy ligero (paseos).', 'Comienza la fase de "shock loss" (ca√≠da del pelo injertado), es normal.', 'Dieta rica en prote√≠nas, vitaminas y minerales.', 'Acudir a la primera revisi√≥n en la cl√≠nica.', 'No usar tintes ni tratamientos qu√≠micos.', 'Tomar primeras fotos de seguimiento.' ] },
            { day: 31, maxDay: 90, phase: 'Crecimiento Inicial', color: '#89b4fa', title: 'Meses 1-3: Primeros Brotes', tasks: [ 'Los primeros cabellos nuevos (finos y cortos) empiezan a ser visibles.', 'Realizar masajes suaves en la zona receptora para estimular circulaci√≥n.', 'Considerar tratamientos como PRP o mesoterapia si se recomend√≥.', 'Usar productos capilares suaves (sin sulfatos, parabenos, siliconas).', 'Empezar a aplicar Minoxidil si fue pautado por el m√©dico.', 'Controlar el estr√©s, es crucial para el crecimiento.', 'Documentar con fotos mensuales.' ] },
            { day: 91, maxDay: 180, phase: 'Consolidaci√≥n', color: '#cba6f7', title: 'Meses 3-6: Aumento de Densidad', tasks: [ 'El cabello nuevo gana grosor y longitud. La densidad mejora.', 'Se puede te√±ir el pelo con tintes vegetales o sin amon√≠aco.', 'Realizar anal√≠tica de sangre para comprobar niveles de ferritina, zinc, etc.', 'El ejercicio cardiovascular es excelente para el riego sangu√≠neo.', 'Continuar con las sesiones de bioestimulaci√≥n (PRP).', 'Los cambios ya son muy evidentes al comparar fotos.' ] },
            { day: 181, maxDay: 365, phase: 'Maduraci√≥n', color: '#8b5cff', title: 'Meses 6-12: Resultado Visible', tasks: [ 'El crecimiento est√° consolidado, el aspecto es m√°s natural.', 'Establecer una rutina de lavado definitiva con productos de calidad.', 'Evaluar el resultado y discutir con el m√©dico si se necesitan retoques.', 'Programar revisiones trimestrales con el especialista.', 'Comparar las fotos del a√±o completo. ¬°Disfruta del cambio!' ] },
            { day: 366, maxDay: Infinity, phase: 'Mantenimiento', color: '#a6adc8', title: 'A√±o 1 en adelante: Cuidado a Largo Plazo', tasks: [ 'El resultado final se alcanza entre los 12 y 18 meses.', 'Mantener h√°bitos saludables de higiene y nutrici√≥n.', 'La protecci√≥n solar del cuero cabelludo debe ser un h√°bito.', 'Programar revisiones anuales para monitoreo a largo plazo.', 'Compartir tu experiencia puede ayudar a otros.' ] }
        ];

        // --- DOM ELEMENTS ---
        const $ = (selector) => document.querySelector(selector);
        const elements = {
            dashboard: $('#dashboard'),
            implantDateValue: $('#implantDateValue'),
            daysSinceValue: $('#daysSinceValue'),
            progressValue: $('#progressValue'),
            nextMilestoneValue: $('#nextMilestoneValue'),
            timelineContainer: $('#timeline-container'),
            timelineProgress: $('#timelineProgress'),
            notificationContainer: $('#notificationContainer')
        };

        // --- APPLICATION LOGIC ---
        const App = {
            init() {
                this.renderDashboard(FIXED_IMPLANT_DATE);
                this.showNotification('Gu√≠a de cuidados cargada.', 'success');
            },
            
            renderDashboard(dateStr) {
                // Correctly create a UTC date to avoid timezone issues.
                // Note: Months are 0-indexed in JavaScript (0=Jan, 5=Jun)
                const [year, month, day] = dateStr.split('-').map(Number);
                const implantDate = new Date(Date.UTC(year, month - 1, day));

                const today = new Date();
                const todayUtc = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));

                const diffTime = todayUtc - implantDate;
                const daysSince = Math.max(0, Math.floor(diffTime / (1000 * 60 * 60 * 24))) + 1;

                // Populate the static date display, ensuring UTC is used for formatting.
                const options = { year: 'numeric', month: 'short', day: 'numeric', timeZone: 'UTC' };
                elements.implantDateValue.textContent = implantDate.toLocaleDateString('es-ES', options);

                this.updateStats(daysSince);
                this.renderTimeline(daysSince);
            },

            updateStats(daysSince) {
                const progress = Math.min((daysSince / MAX_RECOVERY_DAYS) * 100, 100);
                const nextMilestone = careData.find(phase => daysSince < phase.day);

                elements.daysSinceValue.textContent = daysSince;
                elements.progressValue.textContent = `${Math.round(progress)}%`;
                elements.nextMilestoneValue.textContent = nextMilestone ? `D√≠a ${nextMilestone.day}` : 'Finalizado';
            },

            renderTimeline(currentDay) {
                elements.timelineContainer.innerHTML = '';
                let activePhaseRendered = false;

                careData.forEach((phase, index) => {
                    const isActive = currentDay >= phase.day && (careData[index+1] ? currentDay < careData[index+1].day : true);
                    const isCompleted = currentDay >= (careData[index+1] ? careData[index+1].day : phase.day);

                    const item = document.createElement('div');
                    item.className = 'timeline-item';
                    if (isActive) item.classList.add('active');
                    if (isCompleted) item.classList.add('completed');
                    
                    let careListHTML = '';
                    if (isActive) {
                        careListHTML = `<ul class="care-list">${phase.tasks.map(task => `
                            <li class="care-item">
                                <svg class="care-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>
                                <span>${task}</span>
                            </li>`).join('')}
                        </ul>`;
                    }
                    
                    item.innerHTML = `
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">
                                ${phase.title}
                                <span class="timeline-phase" style="background-color: ${phase.color};">${phase.phase}</span>
                            </div>
                            ${careListHTML}
                        </div>
                    `;
                    
                    elements.timelineContainer.appendChild(item);

                    if (isActive && !activePhaseRendered) {
                        setTimeout(() => item.scrollIntoView({ behavior: 'smooth', block: 'center' }), 500);
                        activePhaseRendered = true;
                    }
                });
                
                // Update timeline progress bar height after a short delay to allow rendering
                setTimeout(() => {
                    const totalHeight = elements.timelineContainer.offsetHeight;
                    const progressPercentage = Math.min(currentDay / MAX_RECOVERY_DAYS, 1);
                    elements.timelineProgress.style.height = `${progressPercentage * totalHeight}px`;
                }, 100);
            },

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.textContent = message;
                elements.notificationContainer.appendChild(notification);

                setTimeout(() => notification.classList.add('show'), 100);
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 500);
                }, 4000);
            }
        };

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => App.init());

    })();
    </script>
</body>
</html>
